<HTML>
<HEAD>
<TITLE>ProteinShop User's Manual - Dihedral Angle Files</TITLE>
</HEAD>
<BODY>

<H1>Dihedral Angle Files</H1>

It is often necessary to create not only one, but an entire palette of different conformations for a protein defined by a single amino acid sequence. For example, a global internal energy minimization algorithm might require several initial configurations to converge to a global minimum. In many cases, conformations for a single protein differ at a high level, for example by permuting beta-strands inside beta-sheets, shifting beta-strand alignments, or changing the alignment of adjacent strands in a beta-sheet from parallel to anti-parallel and vice versa. As a step towards high-level manipulation, ProteinShop supports a simple template mechanism to rapidly create many protein structures that differ as mentioned.

<H2>Using Dihedral Angle Files</H2>

At the core of this template mechanism is the ability to save conformations of a subset of coil regions inside a protein to a file, and to load these files back later to act as larger building blocks. As an example, consider a protein structure containing four beta-strands with one coil region between each pair of adjacent strands. A template approach to creating multiple protein structures is to first concentrate on partial beta-sheets containing only two strands each, and to save a dihedral angle file for each created pair. For example, these partial sheets could be 1-2, 2-3, and&nbsp;3-4, each one in several versions (anti-parallel vs. parallel, shifted, etc), see Figure&nbsp;1(b)-(d). Once all these templates have been created manually, it is easy to create complete beta-sheets from the saved building blocks. For example, to create a fully parallel beta-sheet with strand order 1-2-3-4, one would load the dihedral angle files for the parallel versions of pairs&nbsp;1-2, 2-3, and&nbsp;3-4. Creating partially parallel and anti-parallel beta-sheets would work in a similar way, see Figure&nbsp;1(f)-(g). To change the strand order to, say, 2-1-4-3, one would load angle files for pairs 1-2 and&nbsp;3-4, and then manually align strands&nbsp;1-4 (the alignments of strands 2-1-4 and 1-4-3 could then be saved as even larger building blocks), see Figure&nbsp;1(h).<P>

<B>Note:</B> When saving a dihedral angle file for the alignment of two structures, it is important to remember to activate <EM>all</EM> coil regions between those two structures before writing the file. If some coil regions between two structures are not active, the structure alignment can not be reconstructed completely from the saved angle file.

<TABLE WIDTH=100% CELLSPACING=16 CELLPADDING=0 BORDER=0>
<TR><TD ALIGN=CENTER><TABLE CELLSPACING=16 CELLPADDING=0 BORDER=0>
<TR><TD><B>(a)</B>&nbsp;<IMG SRC="DihedralAngleFiles1.png" WIDTH=225 HEIGHT=168 ALIGN=TOP></TD>
<TD><B>(b)</B>&nbsp;<IMG SRC="DihedralAngleFiles2.png" WIDTH=225 HEIGHT=168 ALIGN=TOP></TD></TR>
<TR><TD><B>(c)</B>&nbsp;<IMG SRC="DihedralAngleFiles3.png" WIDTH=225 HEIGHT=168 ALIGN=TOP></TD>
<TD><B>(d)</B>&nbsp;<IMG SRC="DihedralAngleFiles4.png" WIDTH=225 HEIGHT=168 ALIGN=TOP></TD></TR>
<TR><TD><B>(e)</B>&nbsp;<IMG SRC="DihedralAngleFiles5.png" WIDTH=225 HEIGHT=168 ALIGN=TOP></TD>
<TD><B>(f)</B>&nbsp;<IMG SRC="DihedralAngleFiles6.png" WIDTH=225 HEIGHT=168 ALIGN=TOP></TD></TR>
<TR><TD><B>(g)</B>&nbsp;<IMG SRC="DihedralAngleFiles7.png" WIDTH=225 HEIGHT=168 ALIGN=TOP></TD>
<TD><B>(h)</B>&nbsp;<IMG SRC="DihedralAngleFiles8.png" WIDTH=225 HEIGHT=168 ALIGN=TOP></TD></TR>
</TABLE></TD></TR>
<TR><TD><B>Figure 1:</B> Several conformations of protein containing four beta-strands, generated by mixing and matching dihedral angle files. (a)&nbsp;Protein pre-configuration created from prediction file. (b)-(d)&nbsp;Manually generated partial beta-sheets containing pairs of adjacent beta-strands. (e)&nbsp;Intermediate conformation generated by combining two partial beta-sheets. (f)-(g)&nbsp;Complete conformations using different beta-strand permutations and alignment patterns.</TD></TR>
</TABLE>

<H2>Dihedral Angle File Format</H2>

Each dihedral angle file stores dihedral angles for a sequence of coil regions. Accordingly, dihedral angle files are laid out in blocks, one for each coil region whose conformation is stored in the file. Each block is preceded by a header giving the secondary structure index of its associated coil region, the residue index of the coil region's first residue, and the number of residues in the coil region. Following the block header are lines, one for each residue in the coil region, each containing a phi/psi angle pair in degrees. An example dihedral angle file containing two coil regions looks as follows:
<PRE>
4 25 10
  -78.6178     4.0938
  146.8922   103.1488
 -156.8838  -168.3636
 -161.9229  -148.6337
   89.6281  -167.1534
  172.6690  -150.8951
 -175.1816  -101.5526
 -174.0643   179.3910
  177.1078  -163.7736
  -90.5422   -66.8824
6 41 10
  117.5971   -30.0067
 -172.6844  -112.1830
 -114.8363   179.5930
  137.0645   118.2513
  143.2672   136.0750
 -179.0634   158.6883
 -178.5275   132.3876
  -43.0446   132.7349
    7.5369  -166.6106
   30.5659    27.3805
</PRE>
When loading a dihedral angle file, ProteinShop checks the block headers inside the file against the secondary structures in the current protein, and only applies dihedral angles from those blocks that match the current protein. In detail this means that a secondary structure of the given index must exist, it must be a coil region, must start on the same residue index and have the same number of residues. Angle blocks that do not match the current protein are ignored when loading.<P>

The (unintended) side effect of this region matching is that dihedral angle files can not be used as coil region templates in the current program version, in the sense that an n-residue angle block could be applied to any n-residue coil region. This would allow creating even higher-level building blocks such as hairpin turns.

</BODY>
</HTML>
